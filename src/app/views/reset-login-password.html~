<section class="resetLoginPassword-container">
  <div ng-show="resetState === states.RECOVERY">
    <p class="alert alert-info">We will send a reset code to your <a class="bold" href="https://protonmail.com/support/knowledge-base/set-forgot-password-options/" target="_blank" title="This is the optional email you used when first creating an account. This is the same as your notification email that is used for sending alerts about new messages.">recovery email</a> to reset your password.</p>
            <form method="post" name="resetForm" role="form" ng-submit="resetForm.$valid && confirmResetLostPassword(resetForm)" class="pm_form pm_panel">
                <h3 class="text-center margin">Reset Password</h3>
                <div class="margin">
                    <input 
                        tabindex="1" 
		        id="username"  
                        name="username" 
                        type="text" 
                        class="form-control"  
                        ng-model="params.username">
                </div>
                <div ng-messages="resetForm.username.$error" ng-show="resetForm.$submitted || resetForm.username.$touched">
                    <p ng-message="required" class="alert alert-danger">Username required</p>
                </div>
                <div class="margin">
                    <input 
                        tabindex="2" 
                        id="recoveryEmail" 
                        name="recoveryEmail" 
		        type="email" 
                        class="form-control"   
                        ng-model="params.recoveryEmail">
                </div>
                <div ng-messages="resetForm.recoveryEmail.$error" ng-show="resetForm.$submitted || resetForm.recoveryEmail.$touched">
                    <p ng-message="email" class="alert alert-danger">Invalid recovery email</p>
                </div>
                <div class="loginForm-actions">
                    <div class="loginForm-actions-column">
                        <button tabindex="3" class="loginForm-actions-main pm_button primary" type="submit" ng-disabled="networkActivity.loading()">Reset Password</button>
                        <a href="https://protonmail.com/username" class="text-purple">Forgot username?</a>
                    </div>
                </div>
            </form>
        </div>
    
        <div ng-show="resetState === states.CODE">
            <p class="alert alert-info wrap">We've sent a reset code to your <strong>recovery email</strong>. Enter it below to continue.</p>
            <form method="post" ng-submit="tokenForm.$valid && validateToken(tokenForm)" name="tokenForm" class="pm_form pm_panel">
                <h3 class="text-center margin">Reset Password</h3>
                <p class="alert alert-danger">IMPORTANT: Do not close or navigate away from this page. You will need to enter the reset code into the filed below once you receive it.</p>
                <div class="margin">
                    <label for="resetToken">Reset code:</label>
                    <input 
                        type="text" 
                        ng-model="params.resetToken" 
                        id="resetToken" 
		        class="form-control">
                </div>
                <div ng-show="tokenForm.$submitted || tokenForm.resetToken.$touched">
                    <p ng-show="tokenForm.resetToken.$error.required" class="alert alert-danger">Reset code is required</p>
                </div>
                <div class="loginForm-actions">
                    <div class="loginForm-actions-column">
                        <button type="submit" class="loginForm-actions-main pm_button primary" ng-disabled="networkActivity.loading()">Reset Password</button>
                    </div>
                </div>
            </form>
        </div>
    
        <div ng-show="resetState === states.CHECKING">
            <div class="pm_form pm_panel text-center">
                <img src="/assets/img/logo/logo-purple.svg" height="34" /><br><br>
                <div class="creating-loader-container">
                    <atom-loader data-loader-theme="primary"></atom-loader>
                </div>
                <p><span>Verifying reset code</span>...</p>
            </div>
        </div>
    
        <div ng-show="resetState === states.DANGER">
            <form method="post" ng-submit="confirmReset()" name="dangerForm" class="pm_form pm_panel">
                <h1 class="text-center">Warning</h1>
                <p>Resetting your password will also reset your encryption keys, so you will be unable to read your existing messages. <a href="https://protonmail.com/support/knowledge-base/updating-your-login-password/" target="_blank">Learn More</a>.</p>
                <p class="alert alert-danger">ALL YOUR DATA WILL BE LOST!</p>
                <p>
                    <span>To continue, type</span>
                    <kbd>{{dangerWord}}</kbd>
                    <span>below:</span>
                </p>
                <p>
                    <input type="text" class="form-control" ng-model="params.danger" data-danger-word="dangerWord" data-danger />
                </p>
                <div class="alert alert-warning" ng-if="passwordMode === 1">
                    <ul>
                        <li>If you remenber your old password later, you can recover your existing messages. <a href="https://protonmail.com/support/knowledge-base/restoring-encrypted-mailbox/" target="_blank">Learn More</a>.</li>
                    </ul>
                </div>
                <div class="alert alert-warning" ng-if="passwordMode === 2">
                    <ul>
                        <li>Resetting either login or Mailbox password will switch you to <a href="https://protonmail.com/support/knowledge-base/single-password/" target="_blank">Single Password Mode</a>.</li>
                        <li>Resetting either Login or Mailbox password will make old messages unreadable.</li>
                        <li>If you are resetting the Login password only, old messages can be recovered later if you know your existing Mailbox Password. <a href="https://protonmail.com/support/knowledge-base/restoring-encrypted-mailbox/" target="_blank">Learn More</a>.</li>
                    </ul>
                </div>
                <div class="loginForm-actions">
                    <div class="loginForm-actions-row">
                        <a ui-sref="login" class="pm_button">Cancel</a>
                        <button type="submit" ng-disabled="dangerForm.$invalid" class="pm_buton error" title="Reset My Password">Reset</button>
                    </div>
                </div>
            </form>
        </div>
    
        <div ng-show="resetState === states.PASSWORD">
            <p>&nbsp;</p>
            <form method="post" ng-submit="passwordForm.$valid && resetPassword(passwordForm)" name="passwordForm" class="pm_form pm_panel" novalidate>
                <h3 class="text-center margin">Reset Password</h3>
                <p class="text-center alert alert-danger">Keep this password safe--it cannot be recovered.</p>
            <div class="form-group margin">
                <label for="resetToken">New password:</label>
                <password 
                    data-id="password" 
                    data-name="password" 
                    data-form="passwordForm" 
                    data-value="params.password" 
                    data-tabindex="1"></password>
            </div>
            <div class="form-group margin">
                <password 
                    data-id="passwordc" 
                    data-name="passwordc" 
                    data-form="passwordForm" 
                    data-value="params.passwordConfirm" 
                    data-tabindex="2" 
                    compare="params.password"></password>
            </div>
            <div class="alert alert-warning">
                <ul>
                    <li>Do NOT forget this password. If you forget it, you will not be able to login or decrypt your messages.</li>
                    <li>Save your password somewhere safe. Click on <i class="fa fa-eye"></i> icon to confirm you that have type your password correctly.</li>
                </ul>
            </div>
            <div class="loginForm-actions">
                <div class="loginForm-actions-row">
                    <button type="submit" class="loginForm-actions-main pm_button error" ng-disabled="networkActivity.loading()">Reset password</button>
                </div>
            </div>
            </form>
        </div>
    
        <div class="pm_panel wide" ng-show="resetState === states.GENERATE">
            <div class="text-center header">
                <div class="creating-loader-container">
                    <atom-loader data-loader-theme="primary"></atom-loader>
                </div>
                <h2 class="text-center" ng-show="!signupError">Generating keys...</h2>
            </div>
            <p class="alert">This can take a few seconds of a few minutes depending on your device.</p>
        </div>
    
        <div class="pm_panel wide" ng-show="resetState === states.INSTALL" id="setUpProcess">
            <div class="text-center header">
                <div class="creating-loader-container">
                    <atom-loader data-loader-theme="primary"></atom-loader>
                </div>
                <h2 class="text-center">Resetting your password</h2>
            </div>
            <div class="text-left">
                <ol id="creationList">
                    <li class="done">
                        <i class="show fa fa-check"></i>
                        <span>Generating keys</span>
                    </li>
                    <li ng-class="{ 'done': resetAccount }">
                        <i ng-class="{ 'show': resetAccount }" class="fa fa-check"></i>
                        <span>Resetting your password</span>
                    </li>
                    <li ng-class="{ 'done': logUserIn }">
                        <i ng-class="{ 'show': logUserIn }" class="fa fa-check"></i>
                        <span>Logging in to your account</span>
                    </li>
                    <li ng-class="{ 'done': redirectLogin }">
                        <i ng-class="{ 'show': redirectLogin }" class="fa fa-check"></i>
                        <span>Redirecting</span>
                    </li>
                </ol>
            </div>
        </div>
    </section>
